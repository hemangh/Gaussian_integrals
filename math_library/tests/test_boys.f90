program boys_test
    use boys_function, only: boys
    implicit none
    ! double precision :: Boys_func
    integer :: n, io_error
    real(8) :: t, res, deps
    logical          :: exists

    integer, parameter :: num_rows = 45
    integer :: nv(num_rows)
    real(8) :: tv(num_rows), mv(num_rows)
    integer :: i

    data nv /1, 11, 1, 2, 7, 12, 3, 11, 0, 1, 8, 12, 6, 3, 7, 3, 7, 11, 12, 8, &
             6, 8, 12, 4, 8, 0, 4, 11, 0, 11, 0, 8, 10, 11, 3, 8, 1, 7, 9, 5, 8, &
             5, 12, 9, 7 /
    data tv /53.22928592320275D0, 8.628885575617502D0, 58.44599255593447D0,  &
             45.07309159710583D0, 4.416461029030387D0, 24.79083773286591D0,  &
             47.49764196170926D0, 35.81718935383584D0, 41.921495747824196D0,  &
             42.61297143031021D0, 57.27372533101742D0, 39.09316982989988D0,  &
             24.889500431745205D0, 10.448491037529237D0, 0.42594284327091003D0, &
             41.122616210349335D0, 45.58629667750253D0, 35.796860366408936D0,  &
             19.53917056879847D0, 10.22768131948095D0, 55.903458595285D0,  &
             3.6039874292006715D0, 18.62639179380224D0, 49.679295536896404D0, &
             27.016153744808392D0, 3.1708194514061177D0, 49.74922322932589D0, &
             13.013183056179486D0, 48.18962783087747D0, 17.076774164926206D0, &
             42.312336148716284D0, 58.71167142959504D0, 31.075009114364775D0, &
             44.768551195552334D0, 45.54407796124069D0, 53.53842810500481D0,  &
             23.8627985913388D0, 43.06139268262227D0, 0.052942618953274234D0, &
             4.379312947004763D0, 48.30124699974871D0, 36.57520792295574D0,  &
             38.94547512057184D0, 7.154927526154253D0, 52.60326926354554D0 /
    data mv /1.1410087762201478D-03, 2.0881701100855078D-05,  &
             9.91705763877842D-04, 4.87318428334827D-05, 1.5474136454559655D-03, &
             2.5439618162467983D-10, 2.2500596919321376D-06, 7.988097048144708D-12, &
             1.3687576384461847D-01, 1.592950265668186D-03, 8.008347406043104D-12,  &
             8.588801752103966D-13, 1.2136204305485533D-07, 4.489008814198479D-04, &
             4.582754082127531D-02, 3.726178320818612D-06, 3.3872361263550677D-10,  &
             8.040421724461976D-12, 4.817962565629531D-09, 1.371481711658243D-05, &
             6.30722113175838D-10, 2.50747016358831D-03, 8.59387606514009D-09,  &
             1.3546429071533703D-07, 4.75729317600365D-09, 1.31326057490828283D-01, &
             1.3460955492148016D-07, 6.374072903602723D-07, 1.2766391381999115D-01,  &
             3.746124053433235D-08, 1.3624213433405663D-01, 6.486438494156389D-12,  &
             1.210558340482722D-10, 6.141945393633174D-13, 2.6063606668416356D-06,  &
             1.4207129645198062D-11, 3.8013064397875024D-03, 5.193286476551462D-10,  &
             0.0, 2.762785755721239D-03, 3.40814578591376D-11, 6.611490079191906D-08, &
             9.004945000513763D-13, 1.0648198230512679D-04, 1.157463476617741D-10 /
    
    write(*,*) "-------------------------------------------------"// &
    "--------------------------------------------------------------------"
    write(*,'(A5,5A22)') "N", "X", "calculated value", "reference value",  &
     "difference", "rel. difference"
    write(*,*) "-------------------------------------------"// &
    "--------------------------------------------------------------------------"
!     inquire( file=trim("../../input/benchmark.values"), exist=exists )
!     if(exists)then
!         open(unit=20,file='../../input/benchmark.values',status='old',action='read',iostat=io_error)
!         if ( io_error .eq. 0 ) then
    
            do i = 1, num_rows
                !     read(20,*,iostat=io_error) nv, tv, mv
                !     if ( io_error .ne. 0 ) then
                !             exit
                !     end if
                    
                    res = boys(nv(i), tv(i))
                    if ( mv(i) .gt. 0.0 ) then
                            write(*,'(I5,5E22.14)') nv(i), tv(i), res, mv(i), res-mv(i), (res-mv(i))/mv(i)
                    else
                            write(*,'(I5,4E22.14, A22)') nv(i), tv(i), res, mv(i), res-mv(i), "--"
                    end if
            end do
!         else
!             write(*,*) "Error! Can't open 'benchmark.values'!", io_error
!         end if
!     else
!         write(*,*) "File does not exist"
!     endif
    
    close(unit=20)
    
    write(*,*) "-----------------------------------------------------------"// &
    "----------------------------------------------------------"
            
end program
